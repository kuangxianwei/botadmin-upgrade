var OspodLanguage=new Object();OspodLanguage.AvailableLanguages={'de':'German','en':'English','en-au':'English (Australia)','en-ca':'English (Canadian)','en-uk':'English (United Kingdom)','es':'Spanish','fr':'French','it':'Italian','ja':'Japanese','ko':'Korean','ru':'Russian','th':'Thai','zh':'Chinese Traditional','zh-cn':'Chinese Simplified'};OspodLanguage.DefaultLanguage="zh-cn";OspodLanguage.GetActiveLanguage=function(){var sUserLang;var localeCookie="_cmsLocale";var arr=document.cookie.match(new RegExp("(^| )"+localeCookie+"=([^;]*)(;|$)"));if(arr!=null){sUserLang=unescape(arr[2]);};if(sUserLang!=null&&sUserLang!=""){if(sUserLang.length>2){var re=/_/;sUserLang=sUserLang.replace(re,"-");};return sUserLang.toLowerCase();};if(navigator.userLanguage)sUserLang=navigator.userLanguage.toLowerCase();else if(navigator.language)sUserLang=navigator.language.toLowerCase();else{return this.DefaultLanguage;};if(sUserLang.length>=5){sUserLang=sUserLang.substr(0,5);if(this.AvailableLanguages[sUserLang])return sUserLang;};if(sUserLang.length>=2){sUserLang=sUserLang.substr(0,2);if(this.AvailableLanguages[sUserLang])return sUserLang;};return this.DefaultLanguage;};OspodLanguage.LoadLanguage=function(url){document.write('<script type="text/javascript" src="'+url+'" charset="utf-8"><\/script>');};OspodLanguage.languageCheck=function(){try{I18n.language;}catch(err){if(ospodLang!=null&&ospodLang.length>2){OspodLanguage.LoadLanguage(_tplResAddr+"message_"+ospodLang.substr(0,2)+".js?"+_resPatch);};try{I18n.language;}catch(err2){OspodLanguage.LoadLanguage(_tplResAddr+"message_"+this.DefaultLanguage+".js?"+_resPatch);}}};var _isServerRes=false;var _resSvrAddr;var _tplResAddr=_templatePath+"lib/";var _resPatch=0;OspodLanguage.initResParam=function(){var _scripts=document.getElementsByTagName("script");var _matchRE=/(http\:\/\/resource\.ospod\.com\/.+\/).*\/ospodcommon\.js\?(.*)/ig;var scriptSrc;for(var i=0;i<_scripts.length;i++){scriptSrc=_scripts[i].src;if(scriptSrc&&scriptSrc.match(_matchRE)){_isServerRes=true;_resSvrAddr=RegExp.$1;_tplResAddr=_resSvrAddr+"tpl/";_resPatch=RegExp.$2;break;}};if(!_isServerRes&&scriptSrc.match(/.+\/ospodcommon\.js\?(.*)$/ig)){_resPatch=RegExp.$1;}};var ospodLang=OspodLanguage.GetActiveLanguage();try{OspodLanguage.initResParam();OspodLanguage.LoadLanguage(_tplResAddr+"message_"+ospodLang+".js?"+_resPatch);OspodLanguage.languageCheck();}catch(err){};function doZoom(num){var obj=$oe("zoom").css({'fontSize':num,'lineHeight':'auto'});};var __keyDown=false;function keyLimit(event){if(!event){event=getWindowEvent();};var keyCode=event.keyCode?event.keyCode:(event.which?event.which:event.charCode);if((keyCode==116)||(event.ctrlKey&&keyCode==82)){var l=getCookie("_cmsf5");if(cookieEnable()&&!l&&!__keyDown&&!_forbidF5){__keyDown=true;var exp=new Date();exp.setTime(exp.getTime()+3*1000);document.cookie="_cmsf5=anything;expires="+exp.toGMTString();}else{__keyDown=true;if(document.addEventListener){event.preventDefault();}else{event.keyCode=0;};event.returnValue=false;return false;}}};function keyRelease(event){__keyDown=false;};if(window.event)document.captureEvents(Event.MOUSEUP);function forbidContextMenu(event){if(document.addEventListener){if(event.button==2||event.button==3){event.preventDefault();event.returnValue=false;}}else{if(event.button==2||event.button==3){event.keyCode=0;event.button=0;event.cancelBubble=true;event.returnValue=false;}}};function forbidCopy(event){if(document.addEventListener){event.preventDefault();event.returnValue=false;}else{event.keyCode=0;event.cancelBubble=true;event.returnValue=false;};return false;};function forbid(){if(window.addEventListener){document.addEventListener("keydown",keyLimit,false);document.addEventListener("keyup",keyRelease,false);if(_forbidContextMenu){document.addEventListener("contextmenu",forbidContextMenu,false);};if(_forbidCopy){document.addEventListener("selectstart",forbidCopy,false);document.addEventListener("copy",forbidCopy,false);}}else{document.attachEvent("onkeydown",keyLimit);document.attachEvent("onkeyup",keyRelease);if(_forbidContextMenu){document.attachEvent("oncontextmenu",function(){return false;});};if(_forbidCopy){document.attachEvent("onselectstart",function(){return false;});document.attachEvent("oncopy",forbidCopy);}}};try{forbid();}catch(e){};function doCommentSubmit(id){var content=$N("comment.content")[0].value;if(content==null||content==""){alert(I18n.commentContentEmpty);return;};var title=$N("comment.title")[0];if(title.value==null||title.value==""){title.value=I18n.commentDefaultTitle;};var url=_contextPath+"/cfn?cmsfn=0101&ID="+id;$.ajax({url:url,type:"POST",dataType:"xml",data:$oe('commentForm').serialize(),success:function(xml){var status=$(xml).find("status").first().text();var msg=$(xml).find("message").first().text();if(status=="0"){if(msg=="NULL")msg=I18n.commentSuccess;else msg=I18n.commentSuccess+"<br><br>"+msg;request.set("nc","true");var nowLocation=request.getUrl();_error_msg_show(msg,"window.location='"+nowLocation+"'",5,"");}else{if(msg=="NULL")msg=I18n.commentFailure;else msg=I18n.commentFailure+"<br><br>"+msg;_error_msg_show(msg,"",3,"");}}});};function doSupport(id){doCommentValueSubmit("0102",id);};function doDisagree(id){doCommentValueSubmit("0103",id);};function doNoCare(id){doCommentValueSubmit("0104",id);};function doCommentValueSubmit(fn,id){var url=_contextPath+"/cfn?cmsfn="+fn+"&umID="+id;$.ajax({url:url,dataType:"xml",success:function(xml){var status=$(xml).find("status").first().text();var msg=$(xml).find("message").first().text();if(status=="0"){_error_msg_show(I18n.commentValueSuccess,"windowReload()",5,"");}else{_error_msg_show(I18n.commentValueFailure,"",3,"");}}});};function windowReload(){request.set("nc","true");var nowLocation=request.getUrl();window.location=nowLocation;};function doSearchSubmit(id){if(!id){id="searchForm";};var form=document.forms[id];var keyword=$oe('search.keyword').val();if(keyword==null||keyword.replace(/(^\s*)|(\s*$)/g,"")==""){alert(I18n.searchKeywordEmpty);return;};form.action=_contextPath+"/cc?url=_search"+"&nc=true";form.method="post";var e=getEventSrcElement();if(e.tagName.toLowerCase()=="input"&&(e.type=="image"||e.type=="submit")){}else{form.submit();}};function doAdvancedSearchSubmit(id){if(!id){id="searchForm";};var form=document.forms[id];var keyword=$oe('search.keyword').val();if(keyword==null||keyword.replace(/(^\s*)|(\s*$)/g,"")==""){alert(I18n.searchKeywordEmpty);return;};form.action=_contextPath+"/cc?url=_advSearch"+"&nc=true";form.method="post";var e=getEventSrcElement();if(e.tagName.toLowerCase()=="input"&&(e.type=="image"||e.type=="submit")){}else{form.submit();}};function doBoardSubmit(id){if(isNullValue("board.content",I18n.boardContentEmpty))return;if(isNullValue("board.title",I18n.boardTitleEmpty))return;var formValueStr="boardID="+id;var url=_contextPath+"/cfn?cmsfn=0201&"+formValueStr;$.ajax({url:url,type:"POST",data:$oe($N("commentForm")[0]).serialize(false),success:function(xml){var status=$(xml).find("status").first().text();var msg=$(xml).find("message").first().text();if(status=="0"){if(msg=="NULL")msg=I18n.boardCommitSuccess;else msg=I18n.boardCommitSuccess+"<br><br>"+msg;request.set("nc","true");var nowLocation=request.getUrl();_error_msg_show(msg,"window.location='"+nowLocation+"'",5,"");}else{if(msg=="NULL")msg=I18n.boardCommitFailure;else msg=I18n.boardCommitFailure+"<br><br>"+msg;_error_msg_show(msg,"",3,"");}}});};function doVote(xId){var cs=$N("vote."+xId);if(!cs||cs==null||cs==""||cs.length==0){_error_msg_show(I18n.voteItemNotExist,"",3,"");return true;};var ps="";var count=0;for(var i=0;i<cs.length;i++){if(cs[i].checked){if(count>0){ps=ps+"&";};ps=ps+"vote."+xId+"="+cs[i].value;count++;}};if(count==0){_error_msg_show(I18n.voteItemNotSelected,"",3,"");return true;};var url=_contextPath+"/cfn?cmsfn=0301";ps+="&vote.vbox_id="+xId;var nextUrl=_contextPath+"/cc?url=_voteResult&vote.vbox_id="+xId+"&nc=true";url=_contextPath+"/cfn?cmsfn=0301&"+ps+"&forward="+encodeURIComponent(nextUrl)+"&action="+encodeURIComponent(url+"&"+ps);openWindow(url,400,400,"resizable=yes");};function doViewVote(xId){openWindow(_contextPath+"/cc?url=_voteResult&vote.vbox_id="+xId+"&nc=true",400,400,"resizable=yes");};function chgAuthImg(){var authImg=$oe('auth_img');authImg.attr('src',_contextPath+"/cfn?cmsfn=0401"+'&'+Math.random());var cNum=$oe('checkNum.inputNum');cNum.value="";};function doCheckNum(){var url=_contextPath+"/cfn?cmsfn=0402";var inputNum=$oe("checkNum.inputNum");url+="&checkNum.inputNum="+inputNum.val();$.ajax({url:url,type:"GET",success:function(xml){var status=$(xml).find("status").first().text();var msg=$(xml).find("message").first().text();if(status=="0"){var sa=$oe("successAction");var forward=$oe("forward");if(sa.value!=""){new Ajax.Request(sa.val(),{method:'get',onSuccess:function(transport){window.location=forward.val()+"&nc=true";}});}else{window.location=forward.val()+"&nc=true";}}else{chgAuthImg();inputNum=$oe("checkNum.inputNum");inputNum.attr('value','');inputNum.focus();_error_msg_show(msg,"",3,"");}}});};function doUserReg(successUrl){var e=getEventSrcElement();if(e!=null){e.disabled=true;};var url=_contextPath+"/cfn?cmsfn=0501";$.ajax({url:url,type:'POST',dataType:'xml',data:$oe('userRegForm').serialize(),success:function(xml){if(e!=null){e.disabled=false;};userInfoResponse(xml,successUrl);}});};function userInfoResponse(xml,successUrl){var status=$(xml).find("status").first().text();if(!successUrl){request.set("nc","true");var nowLocation=request.getUrl();successUrl=nowLocation;};if(status=="0"){var msg=$(xml).find("message").first().text();_error_msg_show(msg,"window.location='"+successUrl+"';",3,"");}else{$('[name="_error"]').remove();if($(xml).find("message").length==1&&$(xml).find("message > key").length==0){var msg=$(xml).find("message").text();request.set("nc","true");var nowLocation=request.getUrl();_error_msg_show(msg,"window.location='"+nowLocation+"'",3,"");return;};var info="";$(xml).find("message").each(function(index,message){var mKey=$(message).find("key").text();var errorE=$($N(mKey)[0]);if(errorE){var errorInfoE=$('<b class="user_error_info" id="_error" name="_error">'+$(message).find("value").text()+'</b>');errorE.parent().append(errorInfoE);}else{alert(I18n.userNotFoundItem+mKey);}});}};function doUserUpdate(successUrl){var url=_contextPath+"/cfn?cmsfn=0504";$.ajax({url:url,dataType:'xml',type:'POST',data:$oe('userUpdateForm').serialize(),success:function(xml){userInfoResponse(xml,successUrl);}});};function doUserDuplicateCheck(){var url=_contextPath+"/cfn?cmsfn=0503";var uId=$oe("user_id");if(uId.val()==""||uId.val()==null){request.set("nc","true");var nowLocation=request.getUrl();_error_msg_show(I18n.userIdEmpty,"window.location='"+nowLocation+"'",5,"");uId.focus();return;};var ps="uId="+uId.value;$.ajax({url:url,type:'POST',dataType:'xml',data:ps,success:function(xml){var status=$(xml).find("status").text();var msg=$(xml).find("message").text();if(status=="0"){if(msg=="NULL"){msg=I18n.userNotUsed;};_error_msg_show(msg,"",3,"");}else{if(msg=="NULL"){msg=I18n.userAlreadyExist;};_error_msg_show(msg,"",5,"");}}});};function doUserLogin(successUrl){var url=_contextPath+"/cfn?cmsfn=0505";var uId=$oe("user_id");if(!successUrl){request.set("nc","true");successUrl=request.getUrl();};if(uId.val()==""||uId.val()==null){_error_msg_show(I18n.userIdEmpty,"",5,"");uId.focus();return;};var uPasswd=$oe("user_passwd");if(uPasswd.val()==""||uPasswd.val()==null){_error_msg_show(I18n.userPasswordEmpty,"",5,"");uPasswd.focus();return;};var cNum=$oe("checkNum.inputNum");var ps="user_id="+uId.val()+"&user_passwd="+uPasswd.val()+"&checkNum.inputNum="+cNum.val();$.ajax({url:url,type:'GET',dataType:'xml',data:ps,success:function(xml){var status=$(xml).find("status").text();var msg=$(xml).find("message").text();if(status=="0"){window.location=successUrl;}else{_error_msg_show(msg,"",5,"");chgAuthImg();}}});};function doUserInfoEdit(){window.location=_contextPath+'/cc?url=_userEdit&nc=true';};function doRegisterUser(){window.location=_contextPath+'/cc?url=_userReg&nc=true';};function doPasswdRetrieve(){window.location=_contextPath+'/cc?url=_forgetPassword&nc=true';};function doUserLogout(){var url=_contextPath+'/cfn?cmsfn=0506';request.set("nc","true");var nowLocation=request.getUrl();$.ajax({url:url,type:'GET',success:function(data){window.location=nowLocation;return;}});return;};function doRetrievePasswd(){var url=_contextPath+'/cfn?cmsfn=0507';var uId=$N("user_id")[0];var uEmail=$N("user_email")[0];var uQuestion=$N("user_question")[0];var uanswer=$N("user_answer")[0];var cNum=$oe("checkNum.inputNum");var ps="user_id="+uId.value+"&user_email="+uEmail.value+"&user_question="+uQuestion.value+"&user_answer="+uanswer.value+"&checkNum.inputNum="+cNum.val();$.ajax({url:url,type:'POST',dataType:'xml',data:ps,success:function(xml){var status=$(xml).find("status").text();var msg=$(xml).find("message").text();if(status=="0"){_error_msg_show(I18n.userRetrievePasswordSuccess,"",3,"");}else{if(msg=="NULL"){msg=I18n.userRetrievePasswordFailure;};_error_msg_show(msg,"",5,"");}}});};function changeErrorStackStatus(){var e=$oe("errorStackInfo");if($oe("errorStackInfo").css("display")=="none"){$oe("errorStackInfo").css("display","block");}else{$oe("errorStackInfo").css("display","none");}};function cmsDownload(cmsId,fld,flag){if(!cmsId||!fld){alert(I18n.downloadFileNotExist);return false;};var url=_contextPath+"/down?ID="+cmsId+"&fld="+fld;$.ajax({url:url,success:function(feedback){var status=$(feedback).text();if(status&&status=="true"){return true;}else{alert(I18n.downloadInfoUpdateFailure);return false;}}});};function changeLocale(locale){var e=getEventSrcElement();setCookie("_cmsLocale",locale);window.location.reload();};function showLocaleSelector(){var e=getEventSrcElement();var menu=$oe("localeSelect");var ePos=getElementPosition(e);menu.css({'position':'absolute','display':'block','left':(ePos.left+menu.outerWidth()<$("body").outerWidth()?ePos.left:$("body").outerWidth()-menu.outerWidth()),'top':ePos.top+ePos.outerHeight()});};function hiddenLocaleSelector(event){var label=$oe("changeLocale");var menu=$oe("localeSelect");var ePos=getElementPosition(menu);menu.mouseout(function(){$(this).css({'display':'none','scrollLeft':0,'scrollTop':0});});};function OspodSlide(pic,width,height,link,text,itv,spd){if(arguments.length<1){alert(I18n.slideIllegalParameter);return false;};var link=link?link:'';var text=text?text:'';text=text.replace("\"\"","&quot;");var pic=pic;var id='slide'+$.now();this.setSlideType=function(type){slideType=type;};this.setTextBgc=function(tbgc){textBgc=tbgc;};this.setTextHgt=function(thgt){textHgt=thgt;};this.setdNum=function(dnum){dNum=dnum;};this.setSlideBgc=function(bgColor){slideBgc=bgColor;};this.init=function(){var container=$('<div id="container"></div>');var contentDiv=$('<div id="'+id+'" ></div>');var pics=pic.split("|");var links=link.split("|");var texts=text.split("|");for(var i=0;i<pics.length;i++){contentDiv.append('<a href="'+links[i]+'" title="'+texts[i]+'"><img src="'+pics[i]+'" title="'+texts[i]+'"/></a>');};container.append(contentDiv);contentDiv.css({'height':height,'width':width,'padding':0,'margin':0,'overflow':'hidden'});$('img',contentDiv).css({'height':height,'width':width,'padding':0,'border':'1px solid #ccc','background-color':'#eee','top':0,'left':0,'border-radius':3,'-moz-border-radius':3,'-webkit-border-radius':3});document.write(container.html());$.ajax({type:"GET",cache:true,url:_contextPath+"/ec/lib/plugins/slide/jquery.cycle.lite.js",dataType:"script",success:function(){$("#"+id).cycle({fx:'OspodSlide',animIn:{zIndex:$("#"+id).children().size()+3,opacity:1},animOut:{zIndex:0,opacity:0},cssBefore:{opacity:0},fit:1});}});}};function imgZoomer(imgObj,canvas_width,canvas_height){var obj=imgObj;var src_width=GetImageWidth(obj);var src_height=GetImageHeight(obj);var widthScale=src_width/canvas_width;var heightScale=src_height/canvas_height;if(widthScale>=1||heightScale>=1){if(widthScale<heightScale){obj.width=src_width/heightScale;obj.height=canvas_height;}else{obj.width=canvas_width;obj.height=src_height/widthScale;}}else{obj.width=src_width;obj.height=src_height;}};function GetImageWidth(oImage){var OriginImage=new Image();OriginImage.src=oImage.src;return OriginImage.width;};function GetImageHeight(oImage){var OriginImage=new Image();OriginImage.src=oImage.src;return OriginImage.height;};function ImageViewer(obj,dir){buildImageViewer(obj,{showType:'direct'});};function buildImageViewer(obj,option){if(!$.fn.ospodviewer){$.ajax({type:"GET",cache:true,url:_contextPath+"/ec/lib/plugins/viewer/viewer.js",dataType:"script",success:function(){$(obj).ospodviewer(option);}});}else{$(obj).ospodviewer(option);}};function Marquee(elm,width,height,spd,type,wspace){if(arguments.length<1){alert(I18n.marqueeIdEmpty);return false;};var element=elm;var scrollwidth=width?width:800;var scrollheight=height?height:200;scrollwidth=parseInt(scrollwidth);scrollheight=parseInt(scrollheight);var scrollwspace=wspace?wspace:5;var scrolltype=type?type:3;var speed=spd?spd:30;var scrolltext=new Array();var obj1=document.getElementById(element);if(!obj1){alert(I18n.marqueeIllegalParameter);return false;};obj1.style.height=scrollheight+'px';obj1.style.width=scrollwidth+'px';obj1.style.border='0px solid #000';var obj2=document.createElement("div");obj2.id=element+'obj2';var obj3=document.createElement("div");obj3.id=element+"obj3";obj2.style.border='0px solid #000';var objtab=document.createElement('table');var objtr=document.createElement('tr');var objtd=document.createElement('td');objtd.innerHTML=obj1.innerHTML;obj1.innerHTML="";objtab.style.display="inline";objtab.cellpadding="0";objtab.cellspacing="0";objtab.id=element+'tab';objtab.style.border="0px solid #FF0000";objtd.style.whiteSpace="nowrap";objtr.appendChild(objtd);objtab.appendChild(objtr);obj2.innerHTML=objtab.outerHTML;obj1.appendChild(obj2);obj1.appendChild(obj3);obj3.style.width=obj2.style.width=scrollwidth+'px';if(scrolltype==1||scrolltype==2){if(obj2.offsetHeight<scrollheight){var tabheight=scrollheight-obj2.offsetHeight;var tabmarginleft=(obj2.offsetWidth>scrollwidth)?scrollwidth:(obj2.offsetWidth+scrollwidth)/2;if(tabheight<0){tabheight=0;}else{obj2.innerHTML+="<table border=0 style='border:0px solid #ff0000;margin-left:"+tabmarginleft+"px;' cellpadding='0' cellspacing='0'><tr><td style='height:"+tabheight+"px;' nowrap></td></tr></table>";}}};document.write("<style type=\"text/css\">#"+element+"{overflow:hidden;width:"+scrollwidth+"px;}; #"+element+" #"+obj2.id+",#"+element+" #"+obj3.id+"{padding:0px !important;padding:0px;margin:0px !important;margin:0px;float:none;}; #"+obj2.id+" img,#"+obj3.id+" img{margin-right:"+scrollwspace+"px;};</style>");if(scrolltype==3||scrolltype==4){obj1.style.whiteSpace="nowrap";obj2.style.display=ospod.browser.isChrome?"inline-table":"inline";var tabwidth=scrollwidth-obj2.offsetWidth;var tabmargintop=(obj2.offsetHeight>scrollheight)?scrollheight:(obj2.offsetHeight+scrollheight)/2;if(tabwidth<0){tabwidth=0;}else{obj2.innerHTML+="<table border=0 style='display:inline;margin-top:"+tabmargintop+"px;' cellpadding='0' cellspacing='0'><tr><td style='width:"+tabwidth+"px;' nowrap></td></tr></table>";}};obj3.innerHTML=obj2.innerHTML;Marquee.prototype.marqueeScrollTop=function(element,scrolltype,scrollwidth,scrollheight,speed){var obj1=document.getElementById(element);var obj2=document.getElementById(element+"obj2");var obj3=document.getElementById(element+"obj3");if(obj2.offsetHeight>scrollheight)if(obj3.offsetTop-obj1.scrollTop<=0){obj1.scrollTop-=obj3.offsetTop;}else{var oldScrollTop=obj1.scrollTop;obj1.scrollTop++;if(oldScrollTop==obj1.scrollTop){obj1.scrollTop=0;}}else{if(scrollheight-obj1.scrollTop<=0){obj1.scrollTop-=scrollheight;}else{obj1.scrollTop++;}}};Marquee.prototype.marqueeScrollDown=function(element,scrolltype,scrollwidth,scrollheight,speed){var obj1=document.getElementById(element);var obj2=document.getElementById(element+"obj2");var obj3=document.getElementById(element+"obj3");if(document.all){if(obj2.offsetTop-obj1.scrollTop>=0){obj1.scrollTop+=obj3.offsetHeight;}else{obj1.scrollTop--;}}else{if(obj2.offsetTop-obj1.scrollTop-obj2.offsetTop>=0){obj1.scrollTop+=obj3.offsetHeight;}else{obj1.scrollTop--;}}};Marquee.prototype.marqueeScrollLeft=function(element,scrolltype,scrollwidth,scrollheight,speed){var obj1=document.getElementById(element);var obj2=document.getElementById(element+"obj2");var obj3=document.getElementById(element+"obj3");if(obj3.offsetWidth-obj1.scrollLeft<=0){obj1.scrollLeft-=obj2.offsetWidth;}else{obj1.scrollLeft++;}};Marquee.prototype.marqueeScrollRight=function(element,scrolltype,scrollwidth,scrollheight,speed){var obj1=document.getElementById(element);var obj2=document.getElementById(element+"obj2");var obj3=document.getElementById(element+"obj3");if(obj1.scrollLeft<=0){obj1.scrollLeft+=obj3.offsetWidth;}else{obj1.scrollLeft--;}};var count;Marquee.prototype.marqueeStart=function(element,scrolltype,scrollwidth,scrollheight,speed){switch(scrolltype){case 1:if(Marquee.prototype.scrollTopOrDown(element,scrolltype,scrollwidth,scrollheight,speed)){Marquee.prototype.clearInterval(element);count=window.setInterval(Marquee.prototype.marqueeScrollTop.bind(this,element,scrolltype,scrollwidth,scrollheight,speed),speed);MarqueeInterval[element]=count;};break;case 2:if(Marquee.prototype.scrollTopOrDown(element,scrolltype,scrollwidth,scrollheight,speed)){Marquee.prototype.clearInterval(element);count=window.setInterval(Marquee.prototype.marqueeScrollDown.bind(this,element,scrolltype,scrollwidth,scrollheight,speed),speed);MarqueeInterval[element]=count;};break;case 3:Marquee.prototype.scrollLeftOrRight(element,scrolltype,scrollwidth,scrollheight,speed);Marquee.prototype.clearInterval(element);count=window.setInterval(Marquee.prototype.marqueeScrollLeft.bind(this,element,scrolltype,scrollwidth,scrollheight,speed),speed);MarqueeInterval[element]=count;break;case 4:Marquee.prototype.scrollLeftOrRight(element,scrolltype,scrollwidth,scrollheight,speed);Marquee.prototype.clearInterval(element);count=window.setInterval(Marquee.prototype.marqueeScrollRight.bind(this,element,scrolltype,scrollwidth,scrollheight,speed),speed);MarqueeInterval[element]=count;break;}};Marquee.prototype.scrollLeftOrRight=function(element,scrolltype,scrollwidth,scrollheight,speed){var obj3=document.getElementById(element+"obj3");obj3.style.display=ospod.browser.isChrome?"inline-table":"inline";};Marquee.prototype.scrollTopOrDown=function(element,scrolltype,scrollwidth,scrollheight,speed){var obj2=document.getElementById(element+"obj2");if(scrollwidth-obj2.offsetWidth<0){return true;}else{obj2.style.display="block";return true;}};Marquee.prototype.clearInterval=function(element){var interval;for(var key in MarqueeInterval){if(key==element){interval=MarqueeInterval[key];break;}};window.clearInterval(interval);};obj1.onmouseover=function(){Marquee.prototype.clearInterval(element);};obj1.onmouseout=function(){Marquee.prototype.marqueeStart(element,scrolltype,scrollwidth,scrollheight,speed);};Marquee.prototype.marqueeStart(element,scrolltype,scrollwidth,scrollheight,speed);};var MarqueeInterval=new Object();function GetImageSize(oImage){var OriginImage=new Image();if(OriginImage.src!=oImage.src)OriginImage.src=oImage.src;return{"width":OriginImage.width,"height":OriginImage.height};};function ADItemObj(){this.id=0;this.type=1;this.resHeight=100;this.resWidth=100;this.hint="";this.resURL="";this.linkURL="";this.power=1;this.text="";this.getHtml=getADItemHTML;};function getADItemHTML(){var str="";var name="ad_"+this.id;switch(this.type){case 1:str="<A TARGET='_blank' HREF='"+this.linkURL+"'><IMG ID='"+name+"' NAME='"+name+"' BORDER=0 HEIGHT=";str+=this.resHeight+" WIDTH="+this.resWidth+" SRC='"+this.resURL+"' title='"+this.hint+"' ALT='"+this.hint+"'></A>";break;case 2:str="<object classid='clsid:D27CDB6E-AE6D-11cf-96B8-444553540000'  codebase='swflash.cab#version=7,0,0,0'/*tpa=http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=7,0,0,0*/ ";str+=" name='"+name+"' id='"+name+"'  width='"+this.resWidth+"' 	height='"+this.resHeight+"'>";str+="<param name='movie' value='"+this.resURL+"'>";str+="<param name='quality' value='autohigh'>";str+="<embed name='"+name+" id='"+name+"'  width='"+this.resWidth+"' height='"+this.resHeight+"' src='"+this.resURL+"'";str+=" quality='autohigh' pluginspage='http://www.macromedia.com/shockwave/download/index.cgi?P1_Prod_Version=ShockwaveFlash' type='application/x-shockwave-flash'></embed>";str+="</object>";break;case 3:str="<div>"+this.text+"</div>";break;case 4:str="<script>"+this.text+"</script>";break;case 5:str="<IFRAME FRAMEBORDER=0 SCROLLING=NO FRAMESPACING=0 MAGINWIDTH=0 MARGINHEIGHT=0 HEIGHT=";str+=this.resHeight+" WIDTH="+this.resWidth+" SRC='"+this.resURL+"'></IFRAME>";};return str;};function ADFloatDIV(id){this.ID=id;this.divName="";this.status=true;this.virgin=true;this.adItems=new Array();this.currentAD=null;this.htmlDIV=null;this.floatType=1;this.divWidth=100;this.divHeight=100;this.left=-1;this.top=-1;this.dx=2*(Math.random()>0.5?1:-1);this.dy=1*(Math.random()>0.5?1:-1);this.counter=0;this.timer=null;this.step=1;this.rate=10;this.delay=3000;this.setADItem=Float_setADItem;this.adStart=adStart;this.showDIV=Float_showDIV;this.floatDIV=Float_floatDIV;this.pauseMove=Float_pauseMove;this.continueMove=Float_continueMove;this.divInvisible=Float_invisible;this.getCurrentAD=getRandomObj;this.initDiv=FLoat_InitDiv;this.popWindow=pop_window;};function adStart(){if(this.floatType<=10){this.showDIV();}else if(this.floatType>10){this.popWindow();}};function FLoat_InitDiv(){if(this.virgin==false)return;this.virgin=false;if(this.floatType==1||this.floatType==2||this.floatType==3||this.floatType==4){if(this.left<0){this.left=500+500*Math.random()*(Math.random()>0.5?1:-1);};if(this.top<0){this.top=300+300*Math.random()*(Math.random()>0.5?1:-1);}}else if(this.floatType==5||this.floatType==6){if(this.left==-1){this.left=(window.document.body.offsetWidth-this.divWidth)/2;}else if(this.left==-2){this.left=window.document.body.offsetWidth-this.divWidth;};var sHeight=document.documentElement.clientHeight||document.body.clientHeight;if(this.top==-1){this.top=(sHeight-this.divHeight-this.dy-22)/2;}else if(this.top==-2){this.top=sHeight-this.divHeight-this.dy*2-22;}};if(this.left>(window.document.body.offsetWidth-this.divWidth)){this.left=(window.document.body.offsetWidth-this.divWidth)/window.screen.width*this.left;if(this.left>(window.document.body.offsetWidth-this.divWidth)){this.left=(window.document.body.offsetWidth-this.divWidth);}};if(this.top>(window.document.body.offsetHeight-this.divHeight-this.dy*2-22)){this.top=(window.document.body.offsetHeight-this.divHeight-this.dy*2-22)/window.screen.width*this.top;if(this.top>(window.document.body.offsetHeight-this.divHeight-this.dy*2-22)){this.top=(window.document.body.offsetHeight-this.divHeight-this.dy*2-22);}}};function Float_floatDIV(){screenX=document.documentElement.scrollLeft||document.body.scrollLeft;screenY=document.documentElement.scrollTop||document.body.scrollTop;screenW=document.documentElement.clientWidth||document.body.clientWidth;screenW=screenW-this.divWidth;screenH=document.documentElement.clientHeight||document.body.clientHeight;screenH=screenH-this.divHeight-this.dy*2;this.initDiv();var theLeft,theTop;if(this.floatType==1){theLeft=this.left+this.dx*this.step;theTop=this.top+this.dy*this.step;if((theLeft>=screenW&&this.dx>0)||(theLeft<=0&&this.dx<0))this.dx=-1*this.dx;if((theTop>=screenH&&this.dy>0)||(theTop<=0&&this.dy<0))this.dy=-1*this.dy;}else if(this.floatType==2){if(this.counter>=(200/this.rate)){this.dx=(this.dx>0?1:-1)*Math.random()*5;this.dy=(this.dy>0?1:-1)*Math.random()*5;this.counter=0;};this.counter+=1;theLeft=this.left;theTop=this.top+this.dy*this.step;if((theLeft>=screenW&&this.dx>0)||(theLeft<=0&&this.dx<0))this.dx=-1*this.dx;if((theTop>=screenH&&this.dy>0)||(theTop<=0&&this.dy<0))this.dy=-1*this.dy;}else if(this.floatType==3){this.dx=0;theLeft=this.left+this.dx*this.step;theTop=this.top+this.dy*this.step;if((theLeft>=screenW)||(theLeft<=0)){this.left=this.left+this.currentAD.resWidth;};if((theTop>=screenH&&this.dy>0)||(theTop<=0&&this.dy<0))this.dy=-1*this.dy;}else if(this.floatType==4){this.dy=0;theLeft=this.left+this.dx*this.step;theTop=this.top+this.dy*this.step;if((theLeft<=0)){this.dx=-1*this.dx;};if((theLeft>=screenW&&this.dx>0)){this.dx=-1*this.dx;}}else if(this.floatType==5){this.dx=0;this.dy=0;}else if(this.floatType=6){if(document.all){this.htmlDIV.style.pixelLeft=this.left;this.htmlDIV.style.pixelTop=this.top;}else{this.htmlDIV.style.left=this.left+"px";this.htmlDIV.style.top=this.top+"px";};this.htmlDIV.timer=setTimeout(this.ID+".divInvisible()",this.delay);return;};this.left=this.left+this.dx*this.step;this.top=this.top+this.dy*this.step;if(document.all){this.htmlDIV.style.pixelLeft=this.left+screenX;this.htmlDIV.style.pixelTop=this.top+screenY;}else{this.htmlDIV.style.left=this.left+screenX+"px";this.htmlDIV.style.top=this.top+screenY+"px";};var	delay=80/this.rate;clearTimeout(this.htmlDIV.timer);this.htmlDIV.timer=setTimeout(this.ID+".floatDIV()",delay);};function Float_showDIV(){this.currentAD=this.getCurrentAD(this.adItems);this.divHeight=this.currentAD.resHeight;this.divWidth=this.currentAD.resWidth;if(this.currentAD==null||this.currentAD=="")return;this.divName="ADF_"+this.ID;this.divHeight=this.divHeight+22;var str="<DIV id='"+this.divName+"' onMouseOver='"+this.ID+".pauseMove()' onMouseOut='"+this.ID+".continueMove()";str+="' STYLE='position:absolute; visibility:visible; z-index:1; width:";if(document.all){str+=this.divWidth+"; height:"+this.divHeight+"; left:"+this.left+";top:"+this.top+"'>";}else{str+=this.divWidth+"; height:"+this.divHeight+"; left:"+this.left+"px;top:"+this.top+"px'>";};str+=this.currentAD.getHtml();str+="<span  STYLE='display:block;background-color:#ECE9D8;font-size:12px; width:30px; line-height:1.5;text-align:right;padding:2px;cousor:hand'  ><A HREF='javascript:"+this.ID+".divInvisible()'''>"+I18n.adClose+"</A>&nbsp;</span>";str+="</DIV>";document.write(str);this.htmlDIV=$oe(this.divName).get(0);this.floatDIV();};function Float_pauseMove(){clearTimeout(this.htmlDIV.timer);};function Float_continueMove(){if(this.status)this.floatDIV();};function Float_setADItem(ItemObj){var thisLine=this.adItems.length;this.adItems[thisLine]=new Array(ItemObj,ItemObj.power);};function Float_invisible(){clearTimeout(this.htmlDIV.timer);this.htmlDIV.style.visibility="hidden";this.status=false;};function pop_window(){var popC=getCookie("_cmsPopAD");if(popC&&popC>0){return;};this.currentAD=this.getCurrentAD(this.adItems);this.divHeight=this.currentAD.resHeight;this.divWidth=this.currentAD.resWidth;if(this.currentAD==null||this.currentAD=="")return;var str="width="+this.divWidth+"px,height="+this.divHeight+"px,toolbar=0,location=0,status=0,menubar=0,scrollbars=0,resizable=0,";str+="Top="+this.top+",Left="+this.left;var url="http://"+window.location.host+_contextPath+"/cad?_cmsADC="+this.currentAD.id;if(this.floatType==11){window.open(url,"",str);}else if(this.floatType==12){window.open(url,"",str);window.focus();}else if(this.floatType==13){if(browser.isNS){window.open(url,"","modal=yes,"+str);}else{if(browser.isIE7){str="dialogWidth:"+this.divWidth+"px;dialogHeight:"+this.divHeight+"px;dialogLeft:"+this.left+"px;dialogTop:"+this.top+"px;";}else if(browser.isIE){str="dialogWidth:"+(this.divWidth+6)+"px;dialogHeight:"+(this.divHeight+56)+"px;dialogLeft:"+this.left+"px;dialogTop:"+this.top+"px;";}else{str="dialogWidth:"+this.divWidth+"px;dialogHeight:"+this.divHeight+"px;dialogLeft:"+this.left+"px;dialogTop:"+this.top+"px;";};window.showModalDialog(url,window,str);}};setCookie("_cmsPopAD",this.delay,this.delay);};function getRandomObj(array){var totalPower=0;var start=0;for(ii=0;ii<array.length;ii++){totalPower+=array[ii][1];array[ii][2]=start;array[ii][3]=start+array[ii][1];start=array[ii][3];};var theSelected=Math.random()*totalPower;var counter=0;for(ii=0;ii<array.length;ii++){if(theSelected>array[ii][2]&&theSelected<array[ii][3]){return array[ii][0];}}};function staticADDIV(id){this.ID=id;this.adItems=new Array();this.currentAD=null;this.setADItem=static_setADItem;this.setHtml=positionADHTML;this.getCurrentAD=getRandomObj;};function positionADHTML(divName){var divObj=$oe(divName);this.currentAD=this.getCurrentAD(this.adItems);var str=this.currentAD.getHtml();divObj.innerHTML=str;};function static_setADItem(ItemObj){var thisLine=this.adItems.length;this.adItems[thisLine]=new Array(ItemObj,ItemObj.power);};function getVisitCount(url,type,visitID){$.ajax({url:url,type:'GET',dataType:'xml',success:function(xml){var status=$(xml).find("status").text();var msg=$(xml).find("message").text();if(status=="0"){buildVisitCountStyle(msg,type,visitID);}else{buildVisitCountStyle("888888",type,visitID);}}});};function buildVisitCountStyle(count,type,visitID){if(!type){type="NORMAL";};if(!visitID){visitID="visitCount";};if(type=="IMAGE"){var prefix="<img class=\"counterImg\" src=\"img/counter_";var suffix=".gif\">";var result=[];for(var i=0;i<count.length;i++){result.push(prefix);result.push(count.charAt(i));result.push(suffix);};$oe(visitID).after(result.join('')).remove();}else{$oe(visitID).after(count).remove();}};function delKeyWord(defaultKeyWord){var keyWord=document.getElementById("search.keyword");if(keyWord&&defaultKeyWord){if(keyWord.value.replace(/(^\s*)|(\s*$)/g, "")==defaultKeyWord)keyWord.value="";}}function setKeyWord(defaultKeyWord){var keyWord=document.getElementById("search.keyword");if(keyWord&&defaultKeyWord){if(keyWord.value.replace(/(^\s*)|(\s*$)/g, "")=="")keyWord.value=defaultKeyWord;}}function doSearch(defaultKeyWord){keyWord=document.getElementById("search.keyword");var keyWordValue=keyWord.value.replace(/(^\s*)|(\s*$)/g, "");if(keyWordValue=="" || keyWordValue==(defaultKeyWord?defaultKeyWord:"")){alert(I18n.searchKeywordEmpty);keyWord.focus();return false;}else{keyWord.value=keyWordValue;doAdvancedSearchSubmit('');}}



